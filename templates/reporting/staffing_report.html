{% extends "base.html" %}

{% block title %}Звіт по укомплектованості - АСООС 'ОБРІГ'{% endblock %}

{% block content %}
<div class="bg-white p-6 rounded-lg shadow-lg">
    <h1 class="text-3xl font-bold mb-6 text-gray-800">Звіт по укомплектованості</h1>

    <form method="get" class="mb-8 p-4 bg-gray-50 rounded-md">
        <label for="unit_id" class="block text-sm font-medium text-gray-700">Оберіть підрозділ:</label>
        <div class="flex items-center mt-1">
            <select name="unit_id" id="unit_id" class="block w-full rounded-md border-gray-300 shadow-sm focus:border-indigo-500 focus:ring-indigo-500 sm:text-sm">
                <option value="">--- Загальний звіт по бригаді ---</option>
                {% for unit in units %}
                    <option value="{{ unit.pk }}" {% if unit.pk == request.GET.unit_id|add:0 %}selected{% endif %}>
                        {{ unit.name }}
                    </option>
                {% endfor %}
            </select>
            <button type="submit" class="ml-4 px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700">Сформувати</button>
        </div>
    </form>

    {% if report %}
        <h2 class="text-2xl font-semibold mb-4">{{ report.unit_name }}</h2>
        <div class="grid grid-cols-2 md:grid-cols-4 gap-4 mb-6 text-center">
            <div class="bg-gray-100 p-4 rounded-lg">
                <p class="text-sm font-medium text-gray-500">Посад за штатом</p>
                <p class="text-2xl font-bold">{{ report.summary.total_positions }}</p>
            </div>
            <div class="bg-green-100 p-4 rounded-lg">
                <p class="text-sm font-medium text-green-700">Укомплектовано</p>
                <p class="text-2xl font-bold">{{ report.summary.filled_positions }}</p>
            </div>
            <div class="bg-red-100 p-4 rounded-lg">
                <p class="text-sm font-medium text-red-700">Вакантних посад</p>
                <p class="text-2xl font-bold">{{ report.summary.vacant_positions }}</p>
            </div>
            <div class="bg-blue-100 p-4 rounded-lg">
                <p class="text-sm font-medium text-blue-700">% укомплектованості</p>
                <p class="text-2xl font-bold">{{ report.summary.staffing_percentage }}%</p>
            </div>
        </div>

    {% elif summary %}
        <h2 class="text-2xl font-semibold mb-4">Зведений звіт по бригаді</h2>
        <table class="min-w-full bg-white">
            <thead class="bg-gray-800 text-white">
                <tr>
                    <th class="py-2 px-4">Підрозділ</th>
                    <th class="py-2 px-4">Штат</th>
                    <th class="py-2 px-4">Укомплектовано</th>
                    <th class="py-2 px-4">Вакансії</th>
                    <th class="py-2 px-4">%</th>
                </tr>
            </thead>
            <tbody>
            {% for item in summary %}
                <tr class="border-b hover:bg-gray-50">
                    <td class="py-2 px-4 font-medium">{{ item.battalion }}</td>
                    <td class="py-2 px-4 text-center">{{ item.total_positions }}</td>
                    <td class="py-2 px-4 text-center">{{ item.filled_positions }}</td>
                    <td class="py-2 px-4 text-center">{{ item.vacant_positions }}</td>
                    <td class="py-2 px-4 text-center font-bold">{{ item.percentage }}%</td>
                </tr>
            {% endfor %}
            </tbody>
        </table>
    {% endif %}

</div>
{% endblock %}